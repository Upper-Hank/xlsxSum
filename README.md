# XLSX 条件求和工具

一个纯前端的 Excel 条件求和工具。

为了满足老妈的需求，遂vibe之。

[体验网址](https://sum.upper.love)

## 当前功能

- 支持上传 `.xlsx` 文件并本地解析（不上传服务器）
- 支持选择求和列（单列、多列、列区间）
- 支持剔除条件：
  - 背景颜色
  - 数值
  - 公式（按原始公式内容/函数名匹配）
- 支持条件组合逻辑：
  - 任一命中即剔除（OR）
  - 全部命中才剔除（AND）
- 支持手动点选单元格剔除
- 支持三种视图：
  - 原始文件
  - 计算结果（汇总）
  - 输出结果（可下载）
- 移动端适配：
  - 顶部“设置 / 预览”切换
  - 预览工具栏单行布局（左侧视图 tab、右侧行信息）
  - 可下载视图下在底部显示绿色下载按钮
- 条件卡片支持编辑/删除，颜色条件支持可视化色块展示

## 技术特点

- 纯客户端实现，核心依赖 CDN 引入的 `ExcelJS`
- 无后端、无数据库，部署成本低
- 静态资源结构简单：
  - `index.html`
  - `css/style.css`
  - `js/app.js`
  - `icon/`

## 使用方式

1. 打开页面并上传 `.xlsx`
2. 输入求和列（例如：`E,G` 或 `B:D`）
3. 添加剔除条件（可选）
4. 点击“执行条件求和”
5. 在“计算结果（汇总）/输出结果（可下载）”查看并下载

## 静态部署说明

本项目可直接静态部署（Nginx、OSS、GitHub Pages、Vercel 静态站点等）。

最小部署文件：

- `index.html`
- `css/`
- `js/`
- `icon/`

本地验证可直接使用任意静态服务器（如 Python `http.server`）。

## 未来更新计划（Roadmap）

- 支持多个文件同时处理（批处理/并行队列）
- 支持更多条件类型（文本内容、字体颜色、数据验证等）
- 支持多种输出选项（当前仅支持：
  - 单独导出结果汇总
  - 默认方式写回文件：在对应列下呈现结果）
- 条件命中预览增强（高亮统计、快速定位）
- 优化错误提示，不再采用弹窗，而是直接高亮输入框来实现
- 更为统一的用户体验，比如增加条件和指定剔除应该使用同一种逻辑（主要表现为一个是虚框提示，一个是无框文字）
- 导出结果增强（批量导出、命名模板）
- 将指定删除的功能升级为指定表格计算，删除和保留都是对于现有表格状态的反操作，即便为条件pass掉的cell也能用这个功能强行纳入计算
- 适配暗色模式
- 支持浏览器指纹和文件记录